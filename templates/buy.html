<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipkart.com:Secure Payment</title>
    <link rel="icon" href="../static/icons/flipkart-logo-39904.png">
    <link rel="stylesheet" href="../static/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <section>
        <nav id="login-page">
            <div class="main261">   
                <img src="../static/icons/login Flipkart.png">
            </div>     
        </nav>
    <section>
        <div class="main50">
            <div class="main51">
                <div class="lon-name">
                    <div class="Nc">
                        {% if 'user_name' in session %}
                        <div class="Hn">
                            <p class="p1">1</p>
                            <p id="p">LOGIN<i class="bi bi-check2"></i></p>
                        </div>
                        <p class="p2">{{session.user_name}} &nbsp; +91{{ session.password }}</p>
                        {% else %}
                        <div class="Hn">
                            <p class="p1">1</p>
                            <p id="p">Please login</p>
                        </div>
                        <p class="p2"></p>
                        {% endif %}
                    </div>
                    <button>CHANGE</button>
                </div>
                <div class="Del">

                    <div class="Hn">
                        <p class="p1">2</p>
                            <p id="p">DELIVERY ADDRESS</p>
                    </div>
                    {% if 'user_name' in session %}
                    <div class="ress">
                        {% if 'user_name' in session %}
                        <div class="ner">
                            <input type="radio">
                            <p>{{ session.user_name }}</p>
                            <span>HOME</span>
                            <p>{{ session.password }}</p>
                            <a>EDIT</a>
                        </div>
                        {%else%}
                        <div class="ner">
                            <input type="radio">
                            <p></p>
                            <span>HOME</span>
                            <p></p>
                            <a>EDIT</a>
                        </div>
                        {% endif %}
                        <form id="dataForm">
                            <input type="hidden" id="model_name" name="model_name" value="{{data.model_name}}">
                            <input type="hidden" id="storage_details" name="storage_details" value="{{data.storage_details}}">
                            <input type="hidden" id="color" name="color" value="{{data.color}}">
                            <input type="hidden" id="ratings" name="ratings" value="{{data.ratings}}">
                            <input type="hidden" id="price" name="price" value="{{data.price}}">
                            <input type="hidden" id="quantity" name="quantity" value="{{data.quantity}}">
                            <button id="buy-2" type="button" onclick="submitForm()">DELIVER HERE</button>
                        </form>
                        <p id="oder-message"></p>
                        </div>
                    <div class="kl">
                        <i class="fa-solid fa-angle-down"></i><p>View all addresses</p>
                    </div>
                    {% else %}
                    {% endif %}
                </div>
                <div class="kl2">
                    <i class="bi bi-plus"></i><p>Add a new addresses</p>
                </div>
                <div class="uHn">
                    <p class="p1">3</p>
                    <p id="p">ORDER SUMMERY</p>
                </div>
                <div class="uHn">
                    <p class="p1">4</p>
                    <p id="p">PAYMENT OPTIONS</p>
                </div>
            </div>
            <div class="main52">
                <div class="jk">
                    <div class="Gh">
                        <p class="p1">PRICE DETAILS</p>
                    </div>
                    <div class="iop">
                        <p class="p1">Price</p>
                        <p class="p2">₹31,999</p>
                    </div>
                    <div class="iop">
                        <p class="p1">Delivery Charges</p>
                        <p class="p2" id="p"><s>₹70</s> FREE</p>
                    </div>
                    <div class="iop" id="iop">
                        <p class="p1">Packaging Charge</p>
                        <p class="p2">₹99</p>
                    </div>
                    <div class="iop" id="ioc">
                        <p class="p3">Total Payable</p>
                        <div id="p5">
                            ₹
                            <p class="p4" id="p4">32098</p>
                        </div>
                    </div>
                    <div class="fuv1">
                        <p>Quantity</p>
                        <div class="quantity">
                                <button class="minus-btn disabled" type="submit" name="action" value="decrease">-</button>
                                <input type="text" id="quantity_value" value="1">
                                <button class="pluse-btn" type="submit" name="action" value="increase">+</button>
                        </div>
                    </div>
                    <div class="fuv">
                        <p>Your Total savings on this order ₹4,904</p>
                    </div>
                </div>
                <div class="promo-img">
                    <img src="../static/images/promotion_banner_v2_inactive_2.png" alt="Promotions">
                </div>
                <div class="she">
                    <img id=shild src="../static/images/shield_5f9216.png" alt="shiled">
                    <pre>Safe and Secure Payments. Easy returns. 100%
Authenctic products.        
                    </pre>
                </div>
            </div>
        </div>
        <hr>
        <div class="last-foot">
            <a>Policies: Return Policy | Terms of use | Security | Privacy | Infringement <p>© 2007-2024 Flipkart.com</p></a>
            <p class="p2">Need help? Visit the <span>Help Center</span> or <span>Contact Us</span></p>
        </div>
        <script>
            document.querySelector(".minus-btn").setAttribute("disabled","disabled");
            
            var valuecount

            var price = document.getElementById("p4").innerText;
            
            function priceTotal()
            {

                var total = valuecount * price;
                document.getElementById("p4").innerText = total
            }

            document.querySelector(".pluse-btn").addEventListener("click", function()
            {
                valuecount = document.getElementById("quantity_value").value;
                valuecount++;
                document.getElementById("quantity_value").value = valuecount

                if(valuecount > 1)
                {
                    document.querySelector(".minus-btn").removeAttribute("disabled")
                    document.querySelector(".minus-btn").classList.remove("disabled")
                }

                priceTotal()
            })

            document.querySelector(".minus-btn").addEventListener("click", function()
            {
                valuecount = document.getElementById("quantity_value").value;
                valuecount--;
                document.getElementById("quantity_value").value = valuecount

                if(valuecount == 1)
                {
                    document.querySelector(".minus-btn").setAttribute("disabled","disabled")
                }

                priceTotal()
            })
        </script>
        <script>
            function submitForm() {
                const formData = new FormData(document.getElementById('dataForm'));
                
                fetch('/add_details', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    document.getElementById('oder-message').innerText = data.message;
                })
                .catch(error => console.error('Error:', error));
            }
        </script>

</body>
</html>